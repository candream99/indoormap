<!DOCTYPE html>
<html>
<head>
    <title>교보빌딩 1층 실내 지도 (모든 라벨 숨김 v5.0)</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        #map {
            height: 100%;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <script>
        let historicalOverlay = null; 
        let isOverlayVisible = false;

        // 1. 지도상의 거의 모든 라벨을 숨기도록 확장된 스타일 정의
        const HIDE_ALL_LABELS_STYLE = [
            { featureType: "poi", elementType: "labels", stylers: [{ visibility: "off" }] },
            { featureType: "road", elementType: "labels", stylers: [{ visibility: "off" }] },
            { featureType: "transit", elementType: "labels", stylers: [{ visibility: "off" }] },
            { featureType: "administrative", elementType: "labels", stylers: [{ visibility: "off" }] },
            { featureType: "water", elementType: "labels", stylers: [{ visibility: "off" }] },
            { featureType: "landscape", elementType: "labels", stylers: [{ visibility: "off" }] }
        ];

        function initMap() {
            // 경계 및 중심 좌표 설정 (이전과 동일)
            const imageBounds = {
                north: 37.571352, south: 37.570529,
                east: 126.978045, west: 126.977640
            };
            const kyoboCenter = {  
                lat: (imageBounds.north + imageBounds.south) / 2,  
                lng: (imageBounds.east + imageBounds.west) / 2  
            };

            // 2. 지도 생성 (⭐mapTypeId를 'hybrid'로 변경하여 라벨 노출 문제를 줄임)
            const map = new google.maps.Map(document.getElementById('map'), {
                zoom: 18,
                center: kyoboCenter,
                mapTypeId: 'hybrid' 
            });

            // 3. Rectangle 생성 (이전과 동일)
            const rectangle = new google.maps.Rectangle({
                strokeColor: '#FF0000', strokeOpacity: 1.0, strokeWeight: 2,
                fillColor: '#FF0000', fillOpacity: 0.0, 
                bounds: imageBounds, editable: false, zIndex: 10, map: map
            });

            // 4. 이벤트 리스너 설정 (mouseover/mouseout은 동일)
            google.maps.event.addListener(rectangle, 'mouseover', function() {
                if (!isOverlayVisible) { rectangle.setOptions({ fillOpacity: 0.2 }); }
            });
            google.maps.event.addListener(rectangle, 'mouseout', function() {
                if (!isOverlayVisible) { rectangle.setOptions({ fillOpacity: 0.0 }); }
            });

            // C. 영역을 클릭했을 때 (click) : 이미지 토글 및 스타일 변경
            google.maps.event.addListener(rectangle, 'click', function() {
                if (!isOverlayVisible) {
                    // 1. Ground Overlay 생성/표시
                    if (historicalOverlay === null) {
                        historicalOverlay = new google.maps.GroundOverlay(
                            '1F_2.jpg', imageBounds, { opacity: 0.8 }
                        );
                    }
                    historicalOverlay.setMap(map);
                    isOverlayVisible = true;
                    
                    // 2. 확장된 라벨 숨김 스타일 적용 ⭐
                    map.setOptions({ styles: HIDE_ALL_LABELS_STYLE });

                    // 3. 사각형 스타일 변경
                    rectangle.setOptions({ fillOpacity: 0.0, strokeWeight: 4 });
                } else {
                    // 1. 이미지 숨김
                    historicalOverlay.setMap(null);
                    isOverlayVisible = false;

                    // 2. 원래 지도 스타일 복원 (styles: null로 설정하여 제거)
                    map.setOptions({ styles: null });

                    // 3. 사각형 스타일 복원
                    rectangle.setOptions({ strokeWeight: 2, fillOpacity: 0.0 });
                }
            });
        }
    </script>
    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBFx8u1rY7G06Ho4y-nYPLQ4RKy4zsW_og&callback=initMap">
    </script>
</body>
</html>
