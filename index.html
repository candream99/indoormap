<!DOCTYPE html>
<html>
<head>
    <title>교보빌딩 1층 실내 지도 (GroundOverlay & 새 좌표)</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        #map {
            height: 100%;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <script>
        let historicalOverlay = null; 
        let isOverlayVisible = false;

        // 8개의 꼭짓점으로 이루어진 폴리곤 경로 (클릭/호버 영역)
        const BUILDING_PERIMETER = [
            { lat: 37.571348, lng: 126.977638 },
            { lat: 37.571352, lng: 126.978030 },
            { lat: 37.571259, lng: 126.978032 },
            { lat: 37.571259, lng: 126.978156 },
            { lat: 37.570850, lng: 126.978161 },
            { lat: 37.570849, lng: 126.978041 },
            { lat: 37.570532, lng: 126.978044 },
            { lat: 37.570531, lng: 126.977657 }
        ];

        // ⭐ 새로운 두 꼭짓점을 기반으로 한 직사각형 이미지 경계 (GroundOverlay 사용) ⭐
        // Top-Left (NW): (37.571375, 126.977571)
// Bottom-Right (SE): (37.570502, 126.978179)
const imageBounds = {
    north: 37.571375, // 가장 높은 위도
    south: 37.570502, // 가장 낮은 위도
    west: 126.977571,  // 가장 서쪽 경도
    east: 126.978179  // 가장 동쪽 경도
};
        
        // 지도 라벨 숨김 스타일 정의
        const CLEAN_MAP_STYLE = [
            { featureType: "all", elementType: "labels", stylers: [{ visibility: "off" }] },
            { featureType: "all", elementType: "geometry", stylers: [{ saturation: -100 }] }
        ];

        function initMap() {
    // ⭐ 수정할 부분: 새로운 경계를 기반으로 지도 중심 좌표 계산
    const kyoboCenter = {  
        lat: (imageBounds.north + imageBounds.south) / 2, 
        lng: (imageBounds.east + imageBounds.west) / 2
    };

    // ... (나머지 코드는 그대로 유지됩니다)

            // 3. 지도 생성
            const map = new google.maps.Map(document.getElementById('map'), {
                zoom: 18,
                center: kyoboCenter,
                mapTypeId: 'roadmap' 
            });

            // 4. 깨끗한 스타일의 새로운 지도 유형 정의 및 추가
            const cleanMapType = new google.maps.StyledMapType(CLEAN_MAP_STYLE, {
                name: "Clean Map"
            });
            map.mapTypes.set('clean_map', cleanMapType);
            
            // 5. 8개 꼭짓점 Polygon 생성 (클릭/호버 영역)
            const buildingPolygon = new google.maps.Polygon({
                paths: BUILDING_PERIMETER,
                strokeColor: '#FF0000', strokeOpacity: 1.0, strokeWeight: 2,
                fillColor: '#FF0000', fillOpacity: 0.0, 
                zIndex: 10, map: map
            });

            // 마우스 오버/아웃 이벤트
            google.maps.event.addListener(buildingPolygon, 'mouseover', function() {
                if (!isOverlayVisible) { buildingPolygon.setOptions({ fillOpacity: 0.2 }); }
            });
            google.maps.event.addListener(buildingPolygon, 'mouseout', function() {
                if (!isOverlayVisible) { buildingPolygon.setOptions({ fillOpacity: 0.0 }); }
            });

            // 클릭 이벤트 : 이미지 토글 및 지도 유형 변경
            google.maps.event.addListener(buildingPolygon, 'click', function() {
                if (!isOverlayVisible) {
                    // 1. Ground Overlay 생성/표시 (새로운 imageBounds 사용)
                    if (historicalOverlay === null) {
                        historicalOverlay = new google.maps.GroundOverlay(
                            '1F_final2.png', // 이미지 파일명 확인
                            imageBounds, { opacity: 0.8 }
                        );
                    }
                    historicalOverlay.setMap(map);
                    isOverlayVisible = true;
                    
                    // 2. 지도 유형을 라벨이 없는 'clean_map'으로 변경
                    map.setMapTypeId('clean_map'); 

                    // 3. 폴리곤 스타일 변경
                    buildingPolygon.setOptions({ fillOpacity: 0.0, strokeWeight: 4 });
                } else {
                    // 1. 이미지 숨김
                    historicalOverlay.setMap(null);
                    isOverlayVisible = false;

                    // 2. 지도 유형을 원래의 'roadmap'으로 복원
                    map.setMapTypeId('roadmap');

                    // 3. 폴리곤 스타일 복원
                    buildingPolygon.setOptions({ strokeWeight: 2, fillOpacity: 0.0 });
                }
            });
        }
    </script>
    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBFx8u1rY7G06Ho4y-nYPLQ4RKy4zsW_og&callback=initMap">
        </script>
</body>
</html>


